# === Global ===
# Change prefix
unbind-key C-b
set-option -g prefix C-a
bind-key C-a send-prefix

# Eliminate <Esc> delay in vim inside tmux
set-option -s escape-time 0

# key bindings in copy mode
set-option -w -g mode-keys vi
# key bindings in the status line (e.g., command prompt)
set-option -g status-keys emacs
# Enable mouse control (clickable windows, panes, resizable panes)
set-option -g mouse on

# Don't rename windows automatically
set-option -g allow-rename off

# === Styles ===
# Set status bar transparent
# https://stackoverflow.com/questions/22303820/tmux-transparent-status-bar
# set status-bg default
# Alternative:
set-option -g status-style bg=default

# set-option -g status-style 'bg=#32302f fg=#d5c4a1'
set-option -g status-style 'fg=#689d6a'
set-option -g status-right '#{=-21:#(echo #{pane_current_path} | sed 's#$HOME#~#g')} %a %I:%M %p %m-%d-%Y'

# Command message colors
set-option -g message-command-style 'bg=#1d2021 fg=#fe8019 bold'
set-option -g message-style 'bg=default fg=#ebdbb2'

# Pane split border
set-option -g pane-active-border 'fg=#689d6a'
set-option -g pane-border-style 'fg=#928374'

# === Keys for copy-mode-vi ===
bind-key -T copy-mode-vi C-e send-keys -X end-of-line
bind-key -T copy-mode-vi C-b send-keys -X back-to-indentation
bind-key -T copy-mode-vi v   send-keys -X begin-selection
bind-key -T copy-mode-vi C-v send-keys -X rectangle-toggle
bind-key -T copy-mode-vi m   send-keys -X set-mark
bind-key -T copy-mode-vi "'" send-keys -X jump-to-mark
bind-key -T copy-mode-vi y   send-keys -X copy-pipe-and-cancel
bind-key -T copy-mode-vi u   send-keys -X halfpage-up
bind-key -T copy-mode-vi d   send-keys -X halfpage-down

# === Keys for prefix ===
# Reload tmux config file
bind-key -N "Source file" C-r source-file ~/.config/tmux/tmux.conf\; \
  display-message "source-file done: ~/.config/tmux/tmux.conf"

# Select paste buffers
bind-key -N "Choose paste buffer" b choose-buffer -Z

# Scroll up
bind-key -N "Scroll up" u copy-mode -u

# Go to mark
bind-key -N "Go to marked pane" "'" switch-client -t'{marked}'

# Rename
bind-key -N "Rename window"  r command-prompt -I "#W" "rename-window -- '%%'"
bind-key -N "Rename session" R command-prompt -I "#S" "rename-session -- '%%'"

# Kill
bind-key -N "Kill pane"    q   confirm-before -p "kill-pane #P? (y/n)" kill-pane
bind-key -N "Kill window"  Q   confirm-before -p "kill-window #W? (y/n)" kill-window
bind-key -N "Kill session" C-q confirm-before -p "kill-session #S? (y/n)" kill-session

# === Pane: Split ===
# <prefix> v  Horizontal split (left and right)
# <prefix> x  Vertical split (top and bottom)
bind-key -N "Split: vertical"   v split-window -h
bind-key -N "Split: horizontal" x split-window -v
unbind-key '"' # Split current pane into top and bottom
unbind-key % # Split current pane into left and right

# === Pane: Navigation ===
bind-key -r -N "Move pane: left"  h select-pane -L
bind-key -r -N "Move pane: down"  j select-pane -D
bind-key -r -N "Move pane: up"    k select-pane -U
bind-key -r -N "Move pane: right" l select-pane -R

# === Pane: Swap ===
bind-key -N "Swap pane: next" > swap-pane -D
bind-key -N "Swap pane: prev" < swap-pane -U

# === Pane: Resize ===
# use <prefix> M-ArrowKey or <prefix> C-ArrowKey
# bind-key -r -N "Resize pane: left"  M-h resize-pane -L
# bind-key -r -N "Resize pane: down"  M-j resize-pane -D
# bind-key -r -N "Resize pane: up"    M-k resize-pane -U
# bind-key -r -N "Resize pane: right" M-l resize-pane -R

# =============== CUSTOM ===============
# <prefix> C-r     Source file
# <prefix> C-q     Kill session
# <prefix> Q       Kill window
# <prefix> q       Kill pane
# <prefix> u       Scroll up
# <prefix> '       Go to marked pane
# <prefix> r       Rename window
# <prefix> R       Rename session
# <prefix> b       Choose paste buffer
# <prefix> h       Move pane: left
# <prefix> j       Move pane: down
# <prefix> k       Move pane: up
# <prefix> l       Move pane: right
# <prefix> v       Split: vertical
# <prefix> x       Split: horizontal
# <prefix> <       Swap pane: prev
# <prefix> >       Swap pane: next
# =============== DEFAULTS ===============
# <prefix> C-o     Rotate through the panes
# <prefix> C-z     Suspend the current client
# <prefix> Space   Select next layout
# <prefix> !       Break pane to a new window
# <prefix> #       List all paste buffers
# <prefix> $       Rename current session
# <prefix> &       Kill current window
# <prefix> (       Switch to previous client
# <prefix> )       Switch to next client
# <prefix> ,       Rename current window
# <prefix> -       Delete the most recent paste buffer
# <prefix> .       Move the current window
# <prefix> /       Describe key binding
# <prefix> 0-9     Select window 0-9
# <prefix> :       Prompt for a command
# <prefix> ;       Move to the previously active pane
# <prefix> =       Choose a paste buffer from a list
# <prefix> ?       List key bindings
# <prefix> C       Customize options
# <prefix> D       Choose a client from a list
# <prefix> E       Spread panes out evenly
# <prefix> L       Switch to the last client
# <prefix> M       Clear the marked pane
# <prefix> [       Enter copy mode
# <prefix> ]       Paste the most recent paste buffer
# <prefix> c       Create a new window
# <prefix> d       Detach the current client
# <prefix> f       Search for a pane
# <prefix> i       Display window information
# <prefix> m       Toggle the marked pane
# <prefix> n       Select the next window
# <prefix> o       Select the next pane
# <prefix> p       Select the previous window
# <prefix> s       Choose a session from a list
# <prefix> t       Show a clock
# <prefix> w       Choose a window from a list
# <prefix> z       Zoom the active pane
# <prefix> {       Swap the active pane with the pane above
# <prefix> }       Swap the active pane with the pane below
# <prefix> ~       Show messages
# <prefix> Del     Reset so the visible part of the window follows the cursor
# <prefix> PPage   Enter copy mode and scroll up
# <prefix> Up      Select the pane above the active pane
# <prefix> Down    Select the pane below the active pane
# <prefix> Left    Select the pane to the left of the active pane
# <prefix> Right   Select the pane to the right of the active pane
# <prefix> M-1     Set the even-horizontal layout
# <prefix> M-2     Set the even-vertical layout
# <prefix> M-3     Set the main-horizontal layout
# <prefix> M-4     Set the main-vertical layout
# <prefix> M-5     Select the tiled layout
# <prefix> M-n     Select the next window with an alert
# <prefix> M-o     Rotate through the panes in reverse
# <prefix> M-p     Select the previous window with an alert
# <prefix> M-Up    Resize the pane up by 5
# <prefix> M-Down  Resize the pane down by 5
# <prefix> M-Left  Resize the pane left by 5
# <prefix> M-Right Resize the pane right by 5
# <prefix> C-Up    Resize the pane up
# <prefix> C-Down  Resize the pane down
# <prefix> C-Left  Resize the pane left
# <prefix> C-Right Resize the pane right
# <prefix> S-Up    Move the visible part of the window up
# <prefix> S-Down  Move the visible part of the window down
# <prefix> S-Left  Move the visible part of the window left
# <prefix> S-Right Move the visible part of the window right
